---
import Layout from '../../layouts/Layout.astro';
import { languages, useTranslations, type Lang, defaultLang } from '../../i18n/ui';

export function getStaticPaths() {
  return Object.keys(languages).map((lang) => ({
    params: { lang },
  }));
}

interface Props {
  lang?: Lang;
}

const { lang: propLang } = Astro.props as Props;
const { lang: paramLang } = Astro.params as { lang?: Lang };
const lang = (propLang ?? paramLang ?? defaultLang) as Lang;
const t = useTranslations(lang);

// Only add language prefix for non-default locales
const langPrefix = lang === defaultLang ? '' : `/${lang}`;
---

<Layout lang={lang}>
  <main class="download-page">
    <!-- Header Section -->
    <header class="download-header">
      <div class="header-content">
        <a href={`${langPrefix}/`} class="back-link">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          {t('download.backToHome')}
        </a>
        <img src="/hoppy-logo.jpeg" alt="Hoppy logo" class="header-logo" />
        <h1>{t('download.title')}</h1>
        <p class="header-subtitle">{t('download.subtitle')}</p>
      </div>
    </header>

    <!-- Download Content -->
    <section class="download-content">
      <div class="content-wrapper">
        <!-- Platform Toggle -->
        <div class="platform-toggle-container">
          <div class="platform-toggle">
            <button 
              id="apple-btn" 
              class="platform-btn active"
              data-platform="apple"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.08-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
              </svg>
              {t('download.apple')}
            </button>
            <button 
              id="android-btn" 
              class="platform-btn"
              data-platform="android"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.523 15.3414c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.5511 0 .9993.4482.9993.9993.0001.5511-.4482.9997-.9993.9997m-11.046 0c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.551 0 .9993.4482.9993.9993 0 .5511-.4483.9997-.9993.9997m11.4045-6.02l1.9973-3.4592a.416.416 0 00-.1521-.5676.416.416 0 00-.5676.1521l-2.0223 3.503C15.5902 8.2439 13.8533 7.8508 12 7.8508s-3.5902.3931-5.1349 1.0989L4.8429 5.4467a.4161.4161 0 00-.5676-.1521.4157.4157 0 00-.1521.5676l1.9973 3.4592C2.6889 11.186.8532 12.3074.0116 13.9529c-.0807.1548-.0807.3449 0 .4997.8416 1.6455 2.6773 2.7669 4.9287 3.2803.0782.0156.1564.0234.2346.0234.2537 0 .487-.1003.6581-.3005.1807-.2104.2506-.4937.2506-.8042 0-.5511-.4486-.9993-.9993-.9993H4.6226c-1.2889 0-2.4438-.4567-3.3685-1.1931.8416.8416 2.0223 1.3606 3.3685 1.3606h13.5144c1.3462 0 2.527-.519 3.3685-1.3606-.9247.7364-2.0796 1.1931-3.3685 1.1931h-.7378c-.5511 0-.9993.4482-.9993.9993 0 .3105.0699.5938.2506.8042.1711.2002.4044.3005.6581.3005.0782 0 .1564-.0078.2346-.0234 2.2514-.5134 4.0871-1.6348 4.9287-3.2803.0807-.1548.0807-.3449 0-.4997-.8416-1.6455-2.6773-2.7669-4.9287-3.2803z"/>
              </svg>
              {t('download.android')}
            </button>
          </div>
        </div>

        <!-- Apple Content -->
        <div id="apple-content" class="platform-content active">
          <div class="download-card">
            <div class="download-icon">üçé</div>
            <h2>{t('download.ios.title')}</h2>
            <p class="download-description">
              {t('download.ios.description')}
            </p>
            <div class="download-instructions">
              <p><strong>{t('download.ios.instructions')}</strong></p>
              <ol>
                <li>{t('download.ios.step1')}</li>
                <li>{t('download.ios.step2')}</li>
                <li>{t('download.ios.step3')}</li>
              </ol>
            </div>
            <div class="download-links-container">
              <a 
                href="https://apps.apple.com/hk/app/hoppy-learn-10x-faster/id6754865277" 
                target="_blank" 
                rel="noopener noreferrer"
                class="download-link store-badge"
              >
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M17.05 20.28c-.98.95-2.05.88-3.08.4-1.09-.5-2.08-.48-3.24 0-1.44.62-2.2.44-3.08-.4C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
                </svg>
                <span class="store-badge-text">
                  <span class="store-badge-label">{t('home.appStore.downloadOn')}</span>
                  <span class="store-badge-name">{t('home.appStore.appStore')}</span>
                </span>
              </a>
            </div>
          </div>
        </div>

        <!-- Android Content -->
        <div id="android-content" class="platform-content">
          <div class="download-card">
            <div class="download-icon">ü§ñ</div>
            <h2>{t('download.androidSection.title')}</h2>
            <p class="download-description">
              {t('download.androidSection.description')}
            </p>
            <div class="download-instructions">
              <p><strong>{t('download.androidSection.instructions')}</strong></p>
              <ol>
                <li>{t('download.androidSection.step1')}</li>
                <li>{t('download.androidSection.step2')}</li>
                <li>{t('download.androidSection.step3')}</li>
              </ol>
            </div>
            <div class="download-links-container">
              <a 
                href="https://play.google.com/store/apps/details?id=day.hoppy.app" 
                target="_blank" 
                rel="noopener noreferrer"
                class="download-link store-badge google-play-badge"
              >
                <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M3.609 1.814L13.792 12 3.61 22.186a.996.996 0 01-.61-.92V2.734a1 1 0 01.609-.92zm10.89 10.893l2.302 2.302-10.937 6.333 8.635-8.635zm3.199-3.198l2.807 1.626a1 1 0 010 1.73l-2.808 1.626L15.206 12l2.492-2.491zM5.864 2.658L16.8 8.99l-2.302 2.302-8.634-8.634z"/>
                </svg>
                <span class="store-badge-text">
                  <span class="store-badge-label">{t('home.googlePlay.getItOn')}</span>
                  <span class="store-badge-name">{t('home.googlePlay.googlePlay')}</span>
                </span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="download-footer">
      <a href={`${langPrefix}/`} class="footer-link">
        <img src="/hoppy-logo.jpeg" alt="Hoppy logo" class="footer-logo" />
        <span>{t('download.returnHome')}</span>
      </a>
    </footer>
  </main>
</Layout>

<script>
  // Platform toggle functionality
  const appleBtn = document.getElementById('apple-btn');
  const androidBtn = document.getElementById('android-btn');
  const appleContent = document.getElementById('apple-content');
  const androidContent = document.getElementById('android-content');

  function switchPlatform(platform: string) {
    // Update buttons
    if (platform === 'apple') {
      appleBtn?.classList.add('active');
      androidBtn?.classList.remove('active');
      appleContent?.classList.add('active');
      androidContent?.classList.remove('active');
    } else {
      androidBtn?.classList.add('active');
      appleBtn?.classList.remove('active');
      androidContent?.classList.add('active');
      appleContent?.classList.remove('active');
    }
  }

  appleBtn?.addEventListener('click', () => switchPlatform('apple'));
  androidBtn?.addEventListener('click', () => switchPlatform('android'));
</script>

<style>
  .download-page {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    background-color: var(--hoppy-gray);
  }

  /* Header Section */
  .download-header {
    background: linear-gradient(135deg, var(--hoppy-blue) 0%, #35a3c9 100%);
    padding: 2rem 2rem 4rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  .header-content {
    max-width: 800px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
  }

  .back-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--hoppy-white);
    text-decoration: none;
    font-weight: 600;
    font-size: 1rem;
    transition: all 0.3s ease;
    align-self: flex-start;
    padding: 0.5rem 1rem;
    border-radius: 50px;
    background-color: rgba(255, 255, 255, 0.1);
  }

  .back-link:hover {
    background-color: rgba(255, 255, 255, 0.2);
    transform: translateX(-5px);
  }

  .back-link svg {
    width: 20px;
    height: 20px;
  }

  .header-logo {
    width: 120px;
    height: auto;
    padding: 12px;
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 20px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
  }

  .download-header h1 {
    color: var(--hoppy-white);
    margin: 0;
    font-size: clamp(2rem, 5vw, 3rem);
  }

  .header-subtitle {
    color: rgba(255, 255, 255, 0.9);
    font-size: 1.2rem;
    margin: 0;
  }

  /* Content Section */
  .download-content {
    flex: 1;
    padding: 4rem 2rem;
  }

  .content-wrapper {
    max-width: 900px;
    margin: 0 auto;
  }

  /* Platform Toggle */
  .platform-toggle-container {
    display: flex;
    justify-content: center;
    margin-bottom: 3rem;
  }

  .platform-toggle {
    display: flex;
    background-color: var(--hoppy-white);
    border-radius: 50px;
    padding: 0.5rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
    gap: 0.5rem;
  }

  .platform-btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem 2rem;
    border-radius: 50px;
    font-size: 1.1rem;
    font-weight: 600;
    background-color: transparent;
    color: var(--hoppy-gray-dark);
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .platform-btn svg {
    width: 24px;
    height: 24px;
  }

  .platform-btn.active {
    background-color: var(--hoppy-blue);
    color: var(--hoppy-white);
    box-shadow: 0 4px 15px rgba(63, 181, 219, 0.3);
  }

  .platform-btn:hover:not(.active) {
    background-color: var(--hoppy-gray);
    color: var(--hoppy-navy);
  }

  /* Platform Content */
  .platform-content {
    display: none;
    animation: fadeInUp 0.5s ease-out;
  }

  .platform-content.active {
    display: block;
  }

  .download-card {
    background-color: var(--hoppy-white);
    padding: 3rem;
    border-radius: 30px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
    text-align: center;
  }

  .download-icon {
    font-size: 5rem;
    margin-bottom: 1.5rem;
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  .download-card h2 {
    color: var(--hoppy-navy);
    margin-bottom: 1rem;
  }

  .download-description {
    color: var(--hoppy-gray-dark);
    margin-bottom: 2rem;
    line-height: 1.8;
  }

  .download-instructions {
    background-color: var(--hoppy-gray);
    padding: 2rem;
    border-radius: 20px;
    margin: 2rem 0;
    text-align: left;
  }

  .download-instructions p {
    color: var(--hoppy-navy);
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .download-instructions ol {
    color: var(--hoppy-gray-dark);
    padding-left: 1.5rem;
    line-height: 2;
  }

  .download-instructions li {
    margin-bottom: 0.5rem;
  }

  .download-links-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    align-items: center;
    margin-top: 1rem;
  }

  .download-link {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    background-color: var(--hoppy-blue);
    color: var(--hoppy-white);
    padding: 1.25rem 2.5rem;
    border-radius: 50px;
    text-decoration: none;
    font-weight: 600;
    font-size: 1.1rem;
    transition: all 0.3s ease;
  }

  .download-link:hover {
    background-color: #35a3c9;
    box-shadow: 0 8px 25px rgba(63, 181, 219, 0.4);
    transform: translateY(-3px);
  }

  .download-link svg {
    width: 20px;
    height: 20px;
  }

  .download-link.store-badge {
    background-color: #000000;
    padding: 1rem 2rem;
  }

  .download-link.store-badge:hover {
    background-color: #333333;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
  }

  .download-link.store-badge svg {
    width: 28px;
    height: 28px;
  }

  .store-badge-text {
    display: flex;
    flex-direction: column;
    text-align: left;
    line-height: 1.2;
  }

  .store-badge-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    opacity: 0.9;
  }

  .store-badge-name {
    font-size: 1.25rem;
    font-weight: 600;
  }

  /* Footer */
  .download-footer {
    background-color: var(--hoppy-navy);
    padding: 3rem 2rem;
    text-align: center;
  }

  .footer-link {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    text-decoration: none;
    color: var(--hoppy-white);
    font-size: 1.1rem;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .footer-link:hover {
    transform: translateY(-5px);
  }

  .footer-logo {
    width: 120px;
    height: auto;
    padding: 15px;
    background-color: var(--hoppy-white);
    border-radius: 20px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
  }

  .footer-link span {
    color: var(--hoppy-white);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .download-header {
      padding: 1.5rem 1rem 3rem;
    }

    .download-card {
      padding: 2rem 1.5rem;
      border-radius: 20px;
    }

    .download-content {
      padding: 2rem 1rem;
    }

    .platform-toggle {
      width: 100%;
      max-width: 400px;
    }

    .platform-btn {
      flex: 1;
      padding: 0.875rem 1.5rem;
      font-size: 1rem;
    }

    .download-links-container {
      width: 100%;
    }

    .download-link {
      padding: 1rem 2rem;
      font-size: 1rem;
      width: 100%;
      justify-content: center;
    }

    .back-link {
      font-size: 0.9rem;
    }

    .header-logo {
      width: 100px;
    }
  }

  @media (max-width: 480px) {
    .download-card {
      padding: 1.5rem 1rem;
    }

    .download-instructions {
      padding: 1.5rem;
    }

    .download-footer {
      padding: 2rem 1rem;
    }

    .footer-logo {
      width: 100px;
    }

    .platform-btn {
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
    }

    .platform-btn svg {
      width: 20px;
      height: 20px;
    }
  }
</style>


